<div fxLayout="row"
     fxLayoutAlign="center start">
    <div fxFlex="40%"
         fxLayout="column"
         fxLayoutAlign="center stretch">
        <h2 fxLayout="column"
            fxLayoutAlign="start center">Select architecture</h2>
        <div class="filter-header">
            <mat-form-field>
                <input matInput
                       (keyup)="applyFilter(archDataSource, $event.target.value)"
                       placeholder="Filter">
            </mat-form-field>
        </div>
        <div>
            <mat-table #archs
                       [dataSource]="archDataSource">
                <ng-container matColumnDef="position">
                    <mat-cell *matCellDef="let elem"> {{elem.position}} </mat-cell>
                </ng-container>
                <ng-container matColumnDef="name">
                    <mat-cell *matCellDef="let elem"> {{elem.name}} </mat-cell>
                </ng-container>

                <mat-header-row *matHeaderRowDef=""></mat-header-row>
                <mat-row *matRowDef="let row; columns: displayedColumns;"
                         (click)="selectArchitecture(row)"
                         [class.selected-row]="row.id === selectedArchId">
                </mat-row>
            </mat-table>
        </div>
        <div class="import-file">
            <input type="file"
                   (change)="onArchitectureFileChange($event)"
                   accept=".meta">
            <button mat-button
                   (click)="importArchitecture()"
                   [disabled]="!importedArchitecture">
                Import
            </button>
        </div>
    </div>
    <div fxFlex="40%"
         fxLayout="column"
         fxLayoutAlign="center stretch">
        <h2 fxLayout="column"
            fxLayoutAlign="start center">Select model</h2>
        <div class="filter-header">
            <mat-form-field>
                <input matInput
                       (keyup)="applyFilter(modelDataSource, $event.target.value)"
                       placeholder="Filter">
            </mat-form-field>
        </div>
        <div>
            <mat-table #models
                       [dataSource]="modelDataSource">
                <ng-container matColumnDef="position">
                    <mat-cell *matCellDef="let elem"> {{elem.position}} </mat-cell>
                </ng-container>
                <ng-container matColumnDef="name">
                    <mat-cell *matCellDef="let elem"> {{elem.name}} </mat-cell>
                </ng-container>

                <mat-header-row *matHeaderRowDef=""></mat-header-row>
                <mat-row *matRowDef="let row; columns: displayedColumns;"
                         (click)="selectModel(row)"
                         [class.selected-row]="row.id == selectedModelId">
                </mat-row>
            </mat-table>
        </div>
        <div class="import-file">
            <input type="file"
                   (change)="onModelFileChange($event)"
                   accept=".zip">
            <button mat-button
                   (click)="importModel()"
                   [disabled]="!importedModel">
                Import
            </button>
        </div>
    </div>
</div>
<mat-divider></mat-divider>
<div fxLayout="row"
     fxLayoutAlign="center start">
    <div fxFlex="30%"
         fxLayout="column"
         fxLayoutAlign="start center">
        <ng-container *ngIf="!add_new_arch_mode; else addArch">
            <ng-container *ngIf="selArchService.architecture; else noArch">
                <h2>Current architecture</h2>
                <h4>ID: {{ selArchService.architecture.id }}</h4>
                <h4>Name: {{ selArchService.architecture.name }}</h4>
                <h4>Description: {{ selArchService.architecture.description }}</h4>
                <h4>Last used: {{ selArchService.architecture.last_used }}</h4>
                <h4>Last modified: {{ selArchService.architecture.last_modified }}</h4>

                <button mat-button
                        (click)="editCurrentArchitecture()">Edit</button>
                <button mat-button
                        (click)="deleteCurrentArchitecture()">Delete</button>
            </ng-container>
            <ng-template #noArch>
                No architecture selected
            </ng-template>
        </ng-container>
    </div>
    <div fxFlex="30%"
         fxLayout="column"
         fxLayoutAlign="start center">
        <ng-container *ngIf="selArchService.model; else noModel">
            <h2>Current model</h2>
            <h4>ID: {{ selArchService.model.id }}</h4>
            <h4>Name: {{ selArchService.model.name }}</h4>
            <h4>Description: {{ selArchService.model.description }}</h4>

            <h4>Optimizer: {{ selArchService.model.optimizer }}</h4>

            <h4>Batch size: {{ selArchService.model.batch_size }}</h4>
            <h4>Num. of epochs: {{ selArchService.model.nepochs }}</h4>

            <h4>Loss: {{ selArchService.model.loss }}</h4>
            <h4>Training loss: {{ selArchService.model.training_loss }}</h4>
            <h4>Validation loss: {{ selArchService.model.validation_loss }}</h4>

            <button mat-button
                    (click)="editCurrentModel()">Edit</button>
            <button mat-button
                    (click)="deleteCurrentModel()">Delete</button>
        </ng-container>
        <ng-template #noModel>
            No model selected
        </ng-template>
    </div>
</div>
